#!/bin/bash

# c-basic-offset: 4; tab-width: 4; indent-tabs-mode: t
# vi: set shiftwidth=4 tabstop=4 noexpandtab:
# :indentSize=4:tabSize=4:noTabs=false:

set -o nounset
set -o errexit
set -o pipefail


# shellcheck disable=SC1090
source "$HOME/bin/common.bash"
check_debug_logging

if [ x"$1" = xdo ]
then
    dir='.'
    act=do
elif [ x$2 = xdo ]
then
    dir="$1"
    act="do"
elif [ -z "$1" ]
then
    dir='.'
else
    dir="$1"
fi

if [ x$act = xdo ]
then    # act
        find "$dir" -type d -empty | xargs rmdir --parents --verbose
else    # no act
        echo 'Directories that would be deleted:'
        echo
        find "$dir" -type d -empty
        echo
        echo 'Execute "'$0 $1 do'" to delete them.'
fi
