#!/bin/bash

. ~/etc/defaults

# make sure the irssi specific control master ends, so mqtt-irssi disconnects
on_exit() {
    # stop the control master
    ssh ${irssi_host} -O exit
}


if [ "$1" = "lock" ]
then
    ssh ${irssi_host} screen -S irc -X lockscreen
else
    trap on_exit INT TERM KILL EXIT
    ssh -v ${irssi_host} -t "export LOCKPRG=~/bin/irclock; ~/bin/launch-screen irc irssi"
fi

