#!/bin/bash
#set -x
set -e
source $HOME/etc/defaults

# list of jobs to execute in screen
## filter comments and empty lines
JOBS=$(cat <<- EOF | sed -e 's/#.*//' -e '/^\s*$/d'
	mqtt-notify.py
	autocutsel -verbose -selection CLIPBOARD
	#autocutsel -verbose -selection PRIMARY
	pulseaudio-dlna-d # 58080/tcp 65353/udp 1900/udp ALLOW IN
	tail --follow --verbose $HOME/.lockscreen.log  # kaka
	#setbg loop debian
	#rerandr3 daemon
EOF
)

# check if this is a fresh start, whether there's already an i3jobs screen
if (screen -list | grep -q i3jobs)
then
	PAUSE="0"
else
	# wait a bit more after the first job to allow screen to start up
	PAUSE="2"
fi

# launch the jobs
echo "$JOBS" | while read -r line
do
	i3-launch-job $line
	sleep $PAUSE
done

