#!/bin/bash

action="${1:-select}"
screenshotdir="$HOME/tmp"
imagefile="${screenshotdir}/$(date +%Y%m%d%H%M%S).png"

util="/usr/bin/maim --delay 0.2 --format=png --hidecursor --quality 7 --quiet"

case ${action} in
    select)
        options="--select --bordersize 3 --highlight --color 0.3,0.4,0.6,0.4 "
        ;;
    window)
        options="--window $(xdotool getactivewindow)"
        ;;
    screen)
		options="--geometry $(curdispcoor)"
        ;;
    full)
        options=""
        ;;
esac
command="${util} ${options} ${imagefile}"

if ${command}
then
    notify-send --category=transfer.complete \
        --urgency=low --icon=gtk-info \
        "Screenshot ${action}" "saved to ${imagefile}"
    echo -n ${imagefile} | xclip -in -selection clipboard
else
    notify-send --category=transfer.error \
        --urgency=critical --icon=gtk-info \
        "Screenshot failed" "${action}"
fi
