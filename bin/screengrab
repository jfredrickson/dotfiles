#!/bin/bash -x

screenshotdir="$HOME/tmp/Screenshots"
imagefile="${screenshotdir}/$(date +%Y%m%d%H%M%S).png"

case $1 in
    full)
        options="--multidisp"
        ;;
    screen)
        options=""
        ;;
    window)
        options="--focused"
        ;;
    select|*)
        options="--select"
        ;;
esac

mkdir -p "${screenshotdir}"
echo /usr/bin/scrot --silent $options ${imagefile}
# https://code.google.com/p/xmonad/issues/detail?id=476
sleep 0.2
if /usr/bin/scrot --silent --delay 1 $options ${imagefile}
then
    notify-send --category=transfer.complete \
        --urgency=low --icon=gtk-info \
        "Screen grabbed - $1" "saved to ${imagefile}"
    echo -n ${imagefile} | xclip -in -selection clipboard
else
    notify-send --category=transfer.error \
        --urgency=critical --icon=gtk-info \
        "Screen grab error" "$1"
fi
